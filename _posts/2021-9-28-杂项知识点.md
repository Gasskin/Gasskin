---
title: "编辑器杂项知识点"
tags: Unity杂项知识点
---

### 确认弹窗

```c#
if (GUILayout.Button("清空"))
{
    if (EditorUtility.DisplayDialog("警告","确定要...？","Ok","Cancel"))
    {
		// Do Something
    }
    else
    {
    	// Do Something
    }
}
```

### 自定义Inspector显示Script字段

通过ObjectField就可以轻松实现，问题在于如何获得脚本对象？

MonoScript.FromMonoBehaviour可以获得一个MonoScript对象，而MonoScript继承TextAsset继承Object

```c#
GUI.enabled = false;
EditorGUILayout.ObjectField("Script", 
                            MonoScript.FromMonoBehaviour((UIAnimationController)target), 		 															typeof(UIAnimationController), 
                            false);
GUI.enabled = true;
```

或者直接

```c#
serializedObject ??= new SerializedObject (this);
serializedObject.DrawScriptField ();
```

### 打开文件路径选择框

```c#
EditorUtility.OpenFilePanel ();
EditorUtility.OpenFolderPanel ();
```

### 选中Prefab引用的资源

```c#
private static void FindSprite ()
{
    List<Object> selects = new List<Object> ();
        
    var       path  = AssetDatabase.GetAssetPath (Selection.activeGameObject);
    string [] paths = AssetDatabase.GetDependencies(path);
    foreach(string refPath in paths)
    {
        if (refPath.Contains ("Textures"))
        {
            var obj = AssetDatabase.LoadAssetAtPath<Object> (refPath);
            // 想选中什么资源，条件自己判断
            if (...)
            {
                selects.Add (obj);
                EditorGUIUtility.PingObject(obj);
            }
        }
    }

    Selection.objects = selects.ToArray ();
}
```

上面这个，必须选中Project下的Prefab资源才有效，如果想选中Hierarchy中的Prefab资源，则需要

```c#
private static void FindSpriteInHierarchy ()
{
    List<Object> selects = new List<Object> ();

    // 多了这一步
    var source = PrefabUtility.GetCorrespondingObjectFromSource (Selection.activeGameObject);
    var path = AssetDatabase.GetAssetPath (source);
    string [] paths = AssetDatabase.GetDependencies(path);
    
    // 略
}
```

